<ion-header [translucent]="true">
  <ion-toolbar>
    <div slot="start">
      <ion-button fill="clear" href="/tabs/tab1">
        <ion-title>TrendFy</ion-title>
      </ion-button>
    </div>

    <div>
      <ion-title>Market</ion-title>
    </div>

    <div slot="end">
      <ion-menu-button>
        <ion-icon name="menu-outline"></ion-icon>
      </ion-menu-button>
    </div>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <!-- Segment para alternar seções -->
  <ion-segment [(ngModel)]="secaoAtiva" color="primary">
    <ion-segment-button value="produtos">
      <ion-label>Produtos</ion-label>
    </ion-segment-button>
    <ion-segment-button value="carrinho">
      <ion-label>Carrinho</ion-label>
    </ion-segment-button>
    <ion-segment-button value="busca">
      <ion-label>Busca</ion-label>
    </ion-segment-button>
  </ion-segment>

  <!-- Seção de Produtos -->
  <div *ngIf="secaoAtiva === 'produtos'">
    <ion-searchbar (ionInput)="buscarProdutos($event)" placeholder="Pesquisar produtos..."></ion-searchbar>
    <ion-grid>
      <ion-row>
        <ion-col size="12" size-md="3" *ngFor="let produto of produtosFiltrados">
          <ion-card>
            <img [src]="produto.imagem" alt="{{ produto.nome }}" />
            <ion-card-header>
              <ion-card-title>{{ produto.nome }}</ion-card-title>
              <ion-card-subtitle>R$ {{ produto.preco | number:'1.2-2' }}</ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
              <ion-button (click)="adicionarAoCarrinho(produto)" expand="block">Adicionar</ion-button>
            </ion-card-content>
          </ion-card>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>

  <!-- Seção de Carrinho -->
  <div *ngIf="secaoAtiva === 'carrinho'">
    <ion-list>
      <ion-item *ngFor="let item of carrinho">
        <ion-label>
          {{ item.nome }} - R$ {{ item.preco | number:'1.2-2' }}
        </ion-label>
        <ion-button slot="end" color="danger" (click)="removerDoCarrinho(item.id)">
          <ion-icon name="trash-outline"></ion-icon>
        </ion-button>
      </ion-item>
    </ion-list>
    <ion-item>
      <ion-label>Total: R$ {{ calcularTotal() | number:'1.2-2' }}</ion-label>
    </ion-item>
    <ion-button expand="block" (click)="irParaCheckout()" [disabled]="carrinho.length === 0">
      Finalizar Compra
    </ion-button>
  </div>

  <!-- Seção de Busca -->
  <div *ngIf="secaoAtiva === 'busca'">
    <ion-item>
      <ion-label>Filtrar por preço:</ion-label>
      <ion-range min="0" max="500" step="10" [(ngModel)]="filtroPreco" (ionChange)="aplicarFiltro()">
        <ion-label slot="start">R$0</ion-label>
        <ion-label slot="end">R$500</ion-label>
      </ion-range>
    </ion-item>
    <ion-grid>
      <ion-row>
        <ion-col size="12" size-md="3" *ngFor="let produto of produtosFiltrados">
          <ion-card>
            <img [src]="produto.imagem" alt="{{ produto.nome }}" />
            <ion-card-title>{{ produto.nome }}</ion-card-title>
            <ion-card-subtitle>R$ {{ produto.preco | number:'1.2-2' }}</ion-card-subtitle>
          </ion-card>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>
</ion-content>
